function perform(e,t,n){function i(){s=Date.now(),window.requestAnimationFrame?(a=s-o,a>d&&(o=s-a,e()),s<c+t?requestAnimationFrame(i):n()):(e(),s<c+t?setTimeout(i,d):n())}var s,a,r=30,c=Date.now(),o=Date.now(),d=1e3/r;window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,i()}function updateFlex(){$(".flex").each(function(e,t){if($(t).data("gap")){var n=parseFloat($(t).data("gap"))/2+"px";$(t).hasClass("vertical")?($(t).children().css({"margin-top":n,"margin-bottom":n}),$(t).children().first().css("margin-top","0"),$(t).children().last().css("margin-bottom","0")):($(t).children().css({"margin-left":n,"margin-right":n}),$(t).children().first().css("margin-left","0"),$(t).children().last().css("margin-right","0"))}})}function switchTab(e){var t=e.currentTarget;$(t).siblings().removeClass("active"),$(t).addClass("active");var n="#"+$(t).data("target");$(n).siblings().addClass("hidden"),$(n).removeClass("hidden")}function carousel(e){function t(){return $(e).children(".active")}function n(){return 0==t().prev().length?$(e).children().last():t().prev()}function i(){return 0==t().next().length?$(e).children().first():t().next()}function s(){n().hasClass("hidden")&&n().css("left",0-c).removeClass("hidden")}function a(){i().hasClass("hidden")&&i().css("left",c).removeClass("hidden")}function r(){return t().css("left")?parseFloat(t().css("left")):0}var c=$(e).width(),o=$(e).data("timing")?$(e).data("timing"):500,d=[];this.prev=n,this.active=t,this.next=i,this.showPrev=s,this.showNext=a,this.slidePrev=function(){if(!($(e).children().length<2)){s();var a=t(),l=n(),h=i();e.children(":not(.hidden)").moveRight(c-r(),o,function(){a.removeClass("active").addClass("hidden"),l.addClass("active"),d.forEach(function(e){e.apply(this)})}),h.addClass("hidden")}},this.slideNext=function(){if(!($(e).children().length<2)){a();var s=t(),l=n(),h=i();e.children(":not(.hidden)").moveLeft(c+r(),o,function(){s.removeClass("active").addClass("hidden"),h.addClass("active"),d.forEach(function(e){e.apply(this)})}),l.addClass("hidden")}},this.afterSlide=function(e){d.push(e)}}function initCarousel(){$(".carousel").each(function(e,t){if(!($(t).children().length<2)){if(2==$(t).children().length){var n=$(t).children().first(),i=$(t).children().last();$(t).append(n.prop("outerHTML")).append(i.prop("outerHTML"))}$(t).children(".active").length<1&&$(t).children().first().addClass("active"),$(t).children(":not(.active)").addClass("hidden");var s=0,a=0,r=($(t).width(),$(t).carousel()),c=0,o=0,d=0,l=!0,h=!1,f=!1;r.afterSlide(function(){l=!0}),$(t).on("touchstart",function(e){if(!l)return!1;l=!1;var t=e.targetTouches[0].clientX;a=s=t,r.showPrev(),r.showNext(),c=parseFloat(r.prev().css("left")),d=parseFloat(r.next().css("left")),h=!0}),$(t).on("touchmove",function(e){if(!h)return!1;s=e.targetTouches[0].clientX;var t=s-a;r.prev().css("left",c+t),r.active().css("left",o+t),r.next().css("left",d+t),f=!0}),$(t).on("touchend",function(e){return h=!1,f?(f=!1,void(s-5>a?r.slidePrev():s+5<a?r.slideNext():(r.active().css("left",0),r.prev().addClass("hidden"),r.next().addClass("hidden"),l=!0))):(l=!0,!1)})}})}jQuery.fn.carousel=function(){var e=new carousel(this);return e},jQuery.fn.moveRight=function(e,t,n){var i=this,s=[];i.each(function(t,n){var i=$(n).css("left")?parseFloat($(n).css("left")):0;s[t]=i+e}),perform(function(){i.each(function(t,n){var i=$(n).css("left")?parseFloat($(n).css("left")):0;$(n).css("left",i+e/30)})},t,function(){i.each(function(e,t){$(t).css("left",s[e])}),n&&n(this)})},jQuery.fn.moveLeft=function(e,t,n){this.moveRight(-e,t,n)},$(document).ready(function(){initCarousel(),updateFlex(),"undefined"!=typeof Vue&&Vue.nextTick(updateFlex),$(".tab-hover").on("mouseenter",switchTab),$(".tab-click").on("click",switchTab),$(window).resize(function(){initCarousel()})});